// License: MIT
// Code generated with support from CODEX and CODEX CLI.
// Owner / Idea / Management: Dr. Babak Sorkhpour (https://x.com/Drbabakskr)
// lib/transformers.min.js - Local fallback bridge v0.11.2

(function () {
  if (self.transformers) return;
  const env = { allowRemoteModels: false, allowLocalModels: true, localModelPath: '' };
  async function pipeline(task, modelId) {
    if (task !== 'feature-extraction') throw new Error(`Unsupported task in local fallback: ${task}`);
    return async function featureExtractor(text) {
      const t = String(text || '').toLowerCase();
      const v = new Float32Array(32);
      v[0] = t.length / 1500;
      v[1] = /```|function|class|const|import/.test(t) ? 1 : 0;
      v[2] = /https?:\/\//.test(t) ? 1 : 0;
      v[3] = /file|download|attachment|sandbox:\//.test(t) ? 1 : 0;
      return { data: Array.from(v), modelId: modelId || 'local-fallback-embedding' };
    };
  }
  self.transformers = { env, pipeline };
})();
